<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <title>Read and annotate a paragraph from a Wikipedia article</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <!-- jQuery UI -->
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
  <!-- contextMenu -->
  <link rel="stylesheet" href="https://cdn.rawgit.com/swisnl/jQuery-contextMenu/master/dist/jquery.contextMenu.min.css">
  
  <style type="text/css">
.bias-question { width: 800px; position: relative; margin: 20px 0 30px 0; }
.bias-question .slider-labels span { position: absolute; }
.bias-question .slider-labels:before { content: "\00a0"; }
.bias-question .slider { left: 7%; right: 7%; width: 85% }
.bias-question .slider-labels span { font-size: 12px; text-align: center; }
.label-1 { left: 0%; right: 85%; text-align: left; }
.label-2 { left: 14%; right: 71%; text-align: left; }
.label-3 { left: 28%; right: 57%; text-align: center; }
.label-4 { left: 42%; right: 42%; text-align: center; }
.label-5 { left: 57%; right: 28%; text-align: center; }
.label-6 { left: 71%; right: 14%; text-align: right; }
.label-7 { left: 85%; right: 0%; text-align: right; }

#document {-webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
    -o-user-select: none; user-select: none; }
.sentence { cursor: pointer; }
.sentence:hover { text-decoration: underline; }
.united-states-t, .united-states-a, .soviet-t, .soviet-a { border-radius: 2px; padding: 2px; }
.united-states-t { background-color: #d9edf7; }
.united-states-a { background-color: #dff0d8; }
.soviet-t { background-color: #f2dede; }
.soviet-a { background-color: #fcf8e3; }
  </style>
  
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body style="padding: 15px 0;">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div id="instructions" class="panel panel-primary">
          <div class="panel-heading">
            <h4 class="panel-title">
              Instructions <small> <a role="button"
                data-toggle="collapse" href="#instructions-body"> show/hide</a>
              </small>
            </h4>
          </div>
          <div id="instructions-body" class="collapse in">
            <div class="panel-body">
              <p>Hello! Thank you for taking the time to be a part of this
                survey. Today, the following survey is looking to detect and
                understand bias at a sentence level in Spanish texts on media
                about the Cold War. For the purposes of this survey, bias is
                defined as imbalances in presentation that would suggest a
                preference or prejudice. In the following text, we ask that you
                read the sentences, and be able to select whether a specific
                sentence is biased, and the direction in which it is biased.</p>
              <ul>
                <li>If a sentence is biased, please click on that sentence
                  and then select which direction the bias exists: either
                  &ldquo;toward the United States,&rdquo; &ldquo;against the
                  United States,&rdquo; &ldquo;towards the Soviet Union,&rdquo;
                  or &ldquo;against the Soviet Union&rdquo;</li>
                <li>If you later decide that a sentence is not biased,
                  click on that sentence and select &ldquo;clear
                  annotation&rdquo;</li>
              </ul>
              <p>After going through the text and tagging the text with the
              applicable above tags, you will be asked to answer two questions
              determining overall text bias. Upon both tagging the text and
              answering the two questions, you will have completed the survey.</p>
              
              $extra_instructions
            </div>
          </div>
        </div>

        <div id="annotation" class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              Text to annotate <small>(click on a sentence to annotate
                it)</small>
            </h4>
          </div>
          <div class="panel-body" unselectable="on">
            <div id="document">
              $sentences
            </div>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Key: 
              <span class="united-states-t">Biased towards the United States</span>
              <span class="united-states-a">Biased against the United States</span>
              <span class="soviet-t">Biased towards the Soviet Union</span>
              <span class="soviet-a">Biased against the Soviet Union</span>
            </li>
          </ul>
        </div>

        <h4>Questions</h4>
        <ol id="questions">
          <li id="us-bias-question" class="bias-question">
            <p>How biased was the text towards or against the United States?</p>
            <p class="slider"></p>
            <p class="slider-labels">
              <span class="label-1">Very biased against</span>
              <span class="label-2">Moderately biased against</span>
              <span class="label-3">Slightly biased against</span>
              <span class="label-4">Not biased</span>
              <span class="label-5">Slightly biased towards</span>
              <span class="label-6">Moderately biased towards</span>
              <span class="label-7">Very biased towards</span>
            </p>
          </li>
          <li id="soviet-bias-question" class="bias-question">
            <p>How biased was the text towards or against the Soviet Union?</p>
            <p class="slider"></p>
            <p class="slider-labels">
              <span class="label-1">Very biased against</span>
              <span class="label-2">Moderately biased against</span>
              <span class="label-3">Slightly biased against</span>
              <span class="label-4">Not biased</span>
              <span class="label-5">Slightly biased towards</span>
              <span class="label-6">Moderately biased towards</span>
              <span class="label-7">Very biased towards</span>
            </p>
          </li>
        </ol>
      </div>
    </div>
    
    <form action=>
      <input type="hidden" name="sentences" id="sentences-input" />
      <input type="hidden" name="us_bias" id="us-bias-input" />
      <input type="hidden" name="soviet_bias" id="soviet-bias-input" />
    </form>
  </div>

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- Bootstrap JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script src="https://cdn.rawgit.com/swisnl/jQuery-contextMenu/master/dist/jquery.contextMenu.min.js" type="text/javascript"></script>

  <script type="text/javascript">
  
$$(function() {
  $$('.bias-question .slider').slider({
    min: -3, max: 3, step: 1,
    change: function(event, ui) {
        // Get 'us' or 'soviet' depending on which slider this is
        var country = $$(this).parent().attr('id').split('-')[0];
        // Change cooresponding hidden field on form
        $$('#' + country + '-bias-input').val(ui.value);
    }
  }).slider('value', 0);
  
  var sentenceAnnotations = [];
  var annotationClasses = ['sentence', 'united-states-t', 'united-states-a', 'soviet-t', 'soviet-a'];
  var i = 0;
  $$('.sentence').each(function() {
      sentenceAnnotations.push(0);
      $$(this).attr('data-sentence-index', i);
      i++;
  });
  $$('#sentences-input').val(sentenceAnnotations.join(''));
  
  $$.contextMenu({
    selector: '.sentence',
    trigger: 'left',
    callback: function(key, options) {
      $$sentence = $$(this).parents().addBack().filter('.sentence');
      $$sentence.removeClass().addClass('sentence').addClass(key);
      
      var sentenceIndex = parseInt($$sentence.attr('data-sentence-index'));
      for(var classIndex = 0; classIndex < annotationClasses.length; classIndex++) {
          if($$sentence.hasClass(annotationClasses[classIndex])) {
              sentenceAnnotations[sentenceIndex] = classIndex;
          }
      }
      
      // Update hidden form element for sentences
      $$('#sentences-input').val(sentenceAnnotations.join(''));
    },
    items: {
      'united-states-t': {name: 'Biased towards the United States'},
      'united-states-a': {name: 'Biased against the United States'},
      'soviet-t': {name: 'Biased towards the Soviet Union'},
      'soviet-a': {name: 'Biased against the Soviet Union'},
      'sep1': "---------",
      'sentence': {name: 'Clear annotation'}
    }
  });
  $$('.sentence a').on('click', function(e) {
    e.preventDefault();
  });
});
  </script>
</body>
</html>
